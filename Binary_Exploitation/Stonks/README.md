# Stonks
**Category**: Binary Exploitation \
**Points**: 20

## Problem Statement
> I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! See __vuln.c__ \
`nc mercury.picoctf.net 16439`

## Hints
1. > Okay, maybe I'd believe you if you find my API key.

## Solution
Refer to __resources/Binary_Exploitation/format-string-exploitation-tutorial.pdf__.

The API key is read and stored on the stack in `buy_stonks()` (inside a `char[]`), where there also exists a format-string vulnerability from not validating the input to `scanf()`. We can make use of this to dump the entire call stack to obtain the API key.

We can pass in as input `$(python -c 'print("%08x."*50)')` to `buy_stonks()` to format the stack as 4-byte aligned hexidecimal values. Next we pipe this into our script, __hex2ascii.py__, to see the char representation of everything on the stack in both little & big endian. The flag is easily identified amongst the giberish.


## Flag
```
picoCTF{I_l05t_4ll_my_m0n3y_c7cb6cae}
```
